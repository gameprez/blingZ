(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=detect;function detect(){if(arguments.length==0){return $Z._detect.map(function(object){return Promise.resolve(object.detect())})}else{$Z._detect=arguments.length<=0?undefined:arguments[0];return $Z}}},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=detect_actions;function detect_actions(){return Promise.all($Z.detect())}},{}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=done;function done(){if($Z.iter>$Z.maxIter){return true}else{return false}}},{}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=exit;function exit(){if($Z.verbose)console.log("$Z exiting");$Z._item=[];$Z._prep=[];$Z._post=[];$Z._detect=[];$Z._perform=[];$Z._viz={};return false}},{}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=item;function item(){if(arguments.length==0){return $Z._item}else{$Z._item=arguments.length<=0?undefined:arguments[0];return $Z}}},{}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=perform;function perform(){if(arguments.length==0){return $Z._perform.map(function(object){return Promise.resolve(object.perform())})}else{$Z._perform=arguments.length<=0?undefined:arguments[0];return $Z}}},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=perform_actions;function perform_actions(){return Promise.all($Z.perform())}},{}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=pipe;function pipe(task){var prom=Promise.resolve();for(var i=0;i<task.length;i++){prom=prom.then(task[i])}return prom}},{}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=post;function post(){if(arguments.length==0){return $Z._post.map(function(object){return Promise.resolve(object.post())})}else{$Z._post=arguments.length<=0?undefined:arguments[0];return $Z}}},{}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=postprocess;function postprocess(){return Promise.all($Z.post())}},{}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=prep;function prep(){if(arguments.length==0){return $Z._prep.map(function(object){return Promise.resolve(object.prep())})}else{$Z._prep=arguments.length<=0?undefined:arguments[0];return $Z}}},{}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=preprocess;function preprocess(){return Promise.all($Z.prep())}},{}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=render_image;function render_image(){return Promise.all($Z.item().map(function(d){return Promise.resolve(d.render())}))}},{}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=run;function run(){if($Z.verbose)console.log("vizflow run start","$Z.iter",$Z.iter,"$Z.task",$Z.task);$Z.currentTime=Date.now();$Z.sim=$Z.pipe($Z.task)}},{}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=step;function step(){if($Z.verbose){console.log("vizflow step start","$Z.requestAnimFrame",$Z.requestAnimFrame,"$Z.run",$Z.run,"$Z.iter",$Z.iter,"$Z.maxIter",$Z.maxIter)}$Z.iter++;$Z.requestAnimFrame.call(window,$Z.run)}},{}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=step_or_exit;function step_or_exit(){if($Z.verbose){console.log("vizflow: step or exit start")}if($Z.done()){$Z.exit();return Promise.resolve(true)}else{$Z.step();return Promise.resolve(false)}}},{}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=update;function update(){var el=this;var removeList=[];var child=[];if(el.child!==undefined){for(var kc=0;kc<el.child.length;kc++){var d=el.child[kc];d.update?d.update():$Z.update.call(d)}}if(el.transition===undefined)return;if(el.transition.constructor!==Array){el.transition=[el.transition]}for(var kt=0;kt<el.transition.length;kt++){var trans=el.transition[kt];var elapsedTime=0;if(trans.startTime===undefined){trans.startTime=$Z.currentTime}else{elapsedTime=$Z.currentTime-trans.startTime}var remainingTime=trans.duration-elapsedTime;if(elapsedTime==0){trans.startValue=el[trans.varName]}else if(remainingTime>0){var normalizedTime=1-remainingTime/trans.duration;el[trans.varName]=trans.interpFunc(normalizedTime)}else{el[trans.varName]=trans.endValue;if(trans.pause===undefined||-remainingTime>trans.pause){removeList.push(kt);if(trans.child!==undefined){child.push(trans.child)}}}}for(var kr=removeList.length-1;kr>=0;kr--){if(removeList[kr]<el.transition.length-1){var swap=el.transition[el.transition.length-1];el.transition[el.transition.length-1]=el.transition[removeList[kr]];el.transition[removeList[kr]]=swap}var _trans=el.transition.pop();if(_trans.end!==undefined){if(_trans.end.constructor===Array){for(var kEnd=0;kEnd<_trans.end.length;kEnd++){if(typeof _trans.end[kEnd]=="function"){_trans.end[kEnd]()}else{_trans.end[kend].run()}}}else{if(typeof _trans.end=="function"){_trans.end()}else{_trans.end.run()}}}}for(var _kc=0;_kc<child.length;_kc++){el.transition.push(child[_kc])}}},{}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=update_items;function update_items(){return Promise.all($Z.item().map(function(d){return Promise.resolve(d.update?d.update():$Z.update.call(d))})).then(Promise.resolve($Z._viz.update?$Z._viz.update():$Z.update.call($Z._viz)))}},{}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=viz;function viz(){if(arguments.length==0){return $Z._viz}else{$Z.exit();var viz=arguments.length<=0?undefined:arguments[0];if(viz.item!==undefined){$Z._item=viz.item}if(viz.prep!==undefined){$Z._prep.push(viz)}if(viz.post!==undefined){$Z._post.push(viz)}if(viz.detect!==undefined){$Z._detect.push(viz)}if(viz.perform!==undefined){$Z._perform.push(viz)}$Z._viz=viz;return $Z}}},{}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _step=_interopRequireDefault(require("./step"));var _item=_interopRequireDefault(require("./item"));var _prep=_interopRequireDefault(require("./prep"));var _post=_interopRequireDefault(require("./post"));var _detect=_interopRequireDefault(require("./detect"));var _perform=_interopRequireDefault(require("./perform"));var _pipe=_interopRequireDefault(require("./pipe"));var _done=_interopRequireDefault(require("./done"));var _exit=_interopRequireDefault(require("./exit"));var _run=_interopRequireDefault(require("./run"));var _viz=_interopRequireDefault(require("./viz"));var _update=_interopRequireDefault(require("./update"));var _preprocess=_interopRequireDefault(require("./preprocess"));var _update_items=_interopRequireDefault(require("./update_items"));var _detect_actions=_interopRequireDefault(require("./detect_actions"));var _perform_actions=_interopRequireDefault(require("./perform_actions"));var _render_image=_interopRequireDefault(require("./render_image"));var _step_or_exit=_interopRequireDefault(require("./step_or_exit"));var _postprocess=_interopRequireDefault(require("./postprocess"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var vizflow={requestAnimFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,17)},task:[_preprocess["default"],_detect_actions["default"],_perform_actions["default"],_update_items["default"],_render_image["default"],_postprocess["default"],_step_or_exit["default"]],verbose:false,iter:0,maxIter:Infinity,_item:[],_prep:[],_post:[],_detect:[],_perform:[],_viz:{},item:_item["default"],prep:_prep["default"],update:_update["default"],post:_post["default"],detect:_detect["default"],perform:_perform["default"],pipe:_pipe["default"],step:_step["default"],done:_done["default"],exit:_exit["default"],run:_run["default"],viz:_viz["default"]};exports["default"]=vizflow;window.$Z=vizflow},{"./detect":1,"./detect_actions":2,"./done":3,"./exit":4,"./item":5,"./perform":6,"./perform_actions":7,"./pipe":8,"./post":9,"./postprocess":10,"./prep":11,"./preprocess":12,"./render_image":13,"./run":14,"./step":15,"./step_or_exit":16,"./update":17,"./update_items":18,"./viz":19}]},{},[20]);